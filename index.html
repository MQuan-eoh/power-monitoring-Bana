<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bana Hills - Power Monitoring System</title>

    <!-- External Libraries -->
    <script src="https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/modal.css" />
    <link rel="stylesheet" href="css/responsive.css" />
  </head>
  <body>
    <div class="header">
      <div class="header-content">
        <div class="summary-stats">
          <div class="stat-card stat-devices">
            <div class="stat-label">S·ªë thi·∫øt b·ªã</div>
            <div class="stat-value" id="totalDevices">5</div>
            <div class="stat-unit">T·ªß ƒëi·ªán</div>
          </div>

          <div class="stat-card stat-values">
            <div class="stat-label">S·ªë gi√° tr·ªã</div>
            <div class="stat-value" id="totalValues">0</div>
            <div class="stat-unit">Th√¥ng s·ªë</div>
          </div>

          <div class="stat-card stat-online">
            <div class="stat-label">Online</div>
            <div class="stat-value" id="onlineStatus">0/5</div>
            <div class="stat-unit">Thi·∫øt b·ªã</div>
          </div>

          <div class="stat-card stat-connection">
            <div class="stat-label">Tr·∫°ng th√°i k·∫øt n·ªëi</div>
            <div class="connection-status">
              <div class="status-dot"></div>
              <span class="status-text">E-RA Connected</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel 1: ƒêi·ªán √°p -->
    <div class="dashboard-grid">
      <div class="panel-card">
        <div class="panel-header">
          <div class="panel-title">‚ö° T·ªß ƒêi·ªán 1 - ƒêi·ªán √Åp</div>
          <div class="panel-status">
            <div class="status-dot"></div>
            <span>ONLINE</span>
          </div>
        </div>
        <div class="metrics-grid">
          <div class="metric-box">
            <div class="metric-label">U1-N</div>
            <div class="metric-value" id="u1n">
              --<span class="metric-unit">V</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">U2-N</div>
            <div class="metric-value" id="u2n">
              --<span class="metric-unit">V</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">U3-N</div>
            <div class="metric-value" id="u3n">
              --<span class="metric-unit">V</span>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="showHistory('voltage')">
            L·ªãch s·ª≠
          </button>
          <button class="btn btn-secondary" onclick="showDetails('voltage')">
            Chi ti·∫øt
          </button>
        </div>
      </div>

      <!-- Panel 2: D√≤ng ƒëi·ªán -->
      <div class="panel-card">
        <div class="panel-header">
          <div class="panel-title">‚ö° T·ªß ƒêi·ªán 1 - D√≤ng ƒêi·ªán</div>
          <div class="panel-status">
            <div class="status-dot"></div>
            <span>ONLINE</span>
          </div>
        </div>
        <div class="metrics-grid">
          <div class="metric-box">
            <div class="metric-label">I1</div>
            <div class="metric-value" id="i1">
              --<span class="metric-unit">A</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">I2</div>
            <div class="metric-value" id="i2">
              --<span class="metric-unit">A</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">I3</div>
            <div class="metric-value" id="i3">
              --<span class="metric-unit">A</span>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="showHistory('current')">
            L·ªãch s·ª≠
          </button>
          <button class="btn btn-secondary" onclick="showDetails('current')">
            Chi ti·∫øt
          </button>
        </div>
      </div>

      <!-- Panel 3: C√¥ng su·∫•t -->
      <div class="panel-card">
        <div class="panel-header">
          <div class="panel-title">üí° T·ªß ƒêi·ªán 1 - C√¥ng Su·∫•t</div>
          <div class="panel-status">
            <div class="status-dot"></div>
            <span>ONLINE</span>
          </div>
        </div>
        <div class="metrics-grid">
          <div class="metric-box">
            <div class="metric-label">P</div>
            <div class="metric-value" id="power">
              --<span class="metric-unit">kW</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">Q</div>
            <div class="metric-value" id="reactivepower">
              --<span class="metric-unit">kVAr</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">S</div>
            <div class="metric-value" id="apparentpower">
              --<span class="metric-unit">kVA</span>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="showHistory('power')">
            L·ªãch s·ª≠
          </button>
          <button class="btn btn-secondary" onclick="showDetails('power')">
            Chi ti·∫øt
          </button>
        </div>
      </div>

      <!-- Panel 4: Pmax, Imax -->
      <div class="panel-card">
        <div class="panel-header">
          <div class="panel-title">üìà T·ªß ƒêi·ªán 1 - Gi√° Tr·ªã ƒê·ªânh</div>
          <div class="panel-status">
            <div class="status-dot"></div>
            <span>ONLINE</span>
          </div>
        </div>
        <div class="metrics-grid">
          <div class="metric-box">
            <div class="metric-label">Pmax</div>
            <div class="metric-value" id="pmax">
              --<span class="metric-unit">kW</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">Imax</div>
            <div class="metric-value" id="imax">
              --<span class="metric-unit">A</span>
            </div>
          </div>
          <div class="metric-box">
            <div class="metric-label">NƒÉng l∆∞·ª£ng</div>
            <div class="metric-value" id="energy">
              --<span class="metric-unit">kWh</span>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="resetPeak()">
            Reset ƒë·ªânh
          </button>
          <button class="btn btn-secondary" onclick="showDetails('peak')">
            Chi ti·∫øt
          </button>
        </div>
      </div>

      <!-- Panel 5: THD -->
      <div class="panel-card">
        <div class="panel-header">
          <div class="panel-title">üìä T·ªß ƒêi·ªán 1 - THD</div>
          <div class="panel-status">
            <div class="status-dot"></div>
            <span>ONLINE</span>
          </div>
        </div>
        <div class="thd-section">
          <div class="thd-title">THD D√≤ng ƒêi·ªán</div>
          <div class="thd-grid">
            <div class="thd-item">
              <div class="thd-label">THD</div>
              <div class="thd-value" id="thd">--%</div>
            </div>
            <div class="thd-item">
              <div class="thd-label">THD I1</div>
              <div class="thd-value" id="thdi1">--%</div>
            </div>
            <div class="thd-item">
              <div class="thd-label">THD I2</div>
              <div class="thd-value" id="thdi2">--%</div>
            </div>
            <div class="thd-item">
              <div class="thd-label">THD I3</div>
              <div class="thd-value" id="thdi3">--%</div>
            </div>
          </div>
        </div>
        <div class="thd-section thd-section-spacing">
          <div class="thd-title">THD ƒêi·ªán √Åp</div>
          <div class="thd-grid">
            <div class="thd-item">
              <div class="thd-label">THD U1-N</div>
              <div class="thd-value" id="thdu1n">--%</div>
            </div>
            <div class="thd-item">
              <div class="thd-label">THD U2-N</div>
              <div class="thd-value" id="thdu2n">--%</div>
            </div>
            <div class="thd-item">
              <div class="thd-label">THD U3-N</div>
              <div class="thd-value" id="thdu3n">--%</div>
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="showHistory('thd')">
            Xu h∆∞·ªõng THD
          </button>
          <button class="btn btn-secondary" onclick="analyzeTHD()">
            Ph√¢n t√≠ch
          </button>
        </div>
      </div>
    </div>

    <!-- Modal for History/Details -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Chi ti·∫øt d·ªØ li·ªáu</h2>
          <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div id="modalBody">
          <div class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
        </div>
      </div>
    </div>

    <!-- Main JavaScript Module -->
    <script type="module" src="js/main.js"></script>
  </body>
</html>
